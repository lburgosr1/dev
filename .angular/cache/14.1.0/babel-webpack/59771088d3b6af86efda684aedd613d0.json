{"ast":null,"code":"import * as mapboxgl from 'mapbox-gl'; // or \"const mapboxgl = require('mapbox-gl');\"\n\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nconst _c0 = [\"map\"];\n\nconst _c1 = function (a0) {\n  return {\n    \"background-color\": a0\n  };\n};\n\nfunction MarkersComponent_li_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"li\", 5);\n    i0.ɵɵlistener(\"dblclick\", function MarkersComponent_li_3_Template_li_dblclick_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r5);\n      const i_r3 = restoredCtx.index;\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.deleteMarker(i_r3));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const marker_r2 = ctx.$implicit;\n    const i_r3 = ctx.index;\n    i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction1(2, _c1, marker_r2.color));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" marker \", i_r3 + 1, \" \");\n  }\n}\n\nexport let MarkersComponent = /*#__PURE__*/(() => {\n  class MarkersComponent {\n    constructor() {\n      this.zoomLevel = 13;\n      this.center = [-69.94680196984339, 18.489202466590267];\n      this.markers = new Array();\n    }\n\n    ngAfterViewInit() {\n      this.map = new mapboxgl.Map({\n        container: this.divMap.nativeElement,\n        style: 'mapbox://styles/examples/cjgiiz9ck002j2ss5zur1vjji',\n        center: this.center,\n        zoom: this.zoomLevel // starting zoom\n        //projection: 'globe' // display the map as a 3D globe\n\n      });\n      this.map.on('style.load', () => {\n        this.map.setFog({}); // Set the default atmosphere style\n      });\n      this.readLocalStorage();\n      /* const markerHtml: HTMLElement = document.createElement('div');\r\n      markerHtml.innerHTML = 'Hello' */\n      //const marker = new mapboxgl.Marker();\n\n      /* new mapboxgl.Marker({\r\n        element: markerHtml\r\n      }).setLngLat(this.center).addTo(this.map); */\n    }\n\n    addMarker() {\n      const color = \"#xxxxxx\".replace(/x/g, y => (Math.random() * 16 | 0).toString(16));\n      const newMarker = new mapboxgl.Marker({\n        draggable: true,\n        color: color\n      }).setLngLat(this.center).addTo(this.map);\n      this.bgColor = color;\n      this.markers.push({\n        color,\n        marker: newMarker\n      });\n      this.saveLocalStorageMarkers();\n      newMarker.on('dragend', e => {\n        this.saveLocalStorageMarkers();\n      });\n    }\n\n    goToMarker(marker) {\n      this.map.flyTo({\n        center: marker.getLngLat(),\n        duration: 7000,\n        essential: true\n      });\n    }\n\n    saveLocalStorageMarkers() {\n      const lngLatArr = new Array();\n      this.markers.forEach(m => {\n        const color = m.color;\n        const {\n          lng,\n          lat\n        } = m.marker.getLngLat();\n        lngLatArr.push({\n          color: color,\n          center: [lng, lat]\n        });\n      });\n      localStorage.setItem('marker', JSON.stringify(lngLatArr));\n    }\n\n    deleteMarker(i) {\n      var _a;\n\n      console.log(i);\n      (_a = this.markers[i].marker) === null || _a === void 0 ? void 0 : _a.remove();\n      this.markers.splice(i, 1);\n      this.saveLocalStorageMarkers();\n    }\n\n    readLocalStorage() {\n      if (!localStorage.getItem('marker')) {\n        return;\n      }\n\n      const lngLatArr = JSON.parse(localStorage.getItem('marker'));\n      lngLatArr.forEach(m => {\n        const newMarker = new mapboxgl.Marker({\n          color: m.color,\n          draggable: true\n        }).setLngLat(m.center).addTo(this.map);\n        this.markers.push({\n          marker: newMarker,\n          color: m.color\n        });\n        newMarker.on('dragend', e => {\n          this.saveLocalStorageMarkers();\n        });\n      });\n    }\n\n  }\n\n  MarkersComponent.ɵfac = function MarkersComponent_Factory(t) {\n    return new (t || MarkersComponent)();\n  };\n\n  MarkersComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: MarkersComponent,\n    selectors: [[\"app-markers\"]],\n    viewQuery: function MarkersComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n      }\n\n      if (rf & 2) {\n        let _t;\n\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.divMap = _t.first);\n      }\n    },\n    decls: 6,\n    vars: 1,\n    consts: [[1, \"list-group\"], [1, \"list-group-item\", \"list-group-item-dark\", 3, \"click\"], [\"class\", \"list-group-item\", 3, \"ngStyle\", \"dblclick\", 4, \"ngFor\", \"ngForOf\"], [1, \"mapa-container\"], [\"map\", \"\"], [1, \"list-group-item\", 3, \"ngStyle\", \"dblclick\"]],\n    template: function MarkersComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ul\", 0)(1, \"li\", 1);\n        i0.ɵɵlistener(\"click\", function MarkersComponent_Template_li_click_1_listener() {\n          return ctx.addMarker();\n        });\n        i0.ɵɵtext(2, \" + Agregar \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(3, MarkersComponent_li_3_Template, 2, 4, \"li\", 2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(4, \"div\", 3, 4);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngForOf\", ctx.markers);\n      }\n    },\n    dependencies: [i1.NgForOf, i1.NgStyle],\n    styles: [\".mapa-container[_ngcontent-%COMP%]{width:100%;height:100%}.list-group[_ngcontent-%COMP%]{position:fixed;top:65px;left:10px;z-index:999;cursor:pointer}\"]\n  });\n  return MarkersComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}